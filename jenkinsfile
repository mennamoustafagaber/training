node {
    def app

    stage('Clone repository') {
               checkout scm
    }
    
    stage('build image') {
                 app = docker.build("mennabelalesraa/example-app")
    }    
    
    stage('test image') {
                    app.inside { 
                         sh 'rm -rf node_modules package-lock.json && npm install && npm start && npm test'
    }                 }  
}

